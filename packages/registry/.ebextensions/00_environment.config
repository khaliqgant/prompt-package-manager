# Environment Variables Configuration
# These should match what's configured in the Beanstalk console
# This file documents the expected environment variables but doesn't set them
# (they're set through the console or infrastructure code)

# Note: This config ensures the variables are properly available to the application
# The actual values should be set in the Beanstalk console under:
# Configuration > Software > Environment properties

option_settings:
  aws:elasticbeanstalk:application:environment:
    # Node.js Configuration
    NODE_ENV: production
    PORT: 8080
    LOG_LEVEL: info

    # Database
    # DATABASE_URL should be set in console: postgresql://user:pass@host:5432/dbname

    # Redis Cache
    # REDIS_URL should be set in console: redis://host:6379

    # Search Engine
    SEARCH_ENGINE: postgres

    # JWT Authentication
    # JWT_SECRET should be set in console
    JWT_EXPIRES_IN: 7d

    # Nango OAuth Integration
    # NANGO_API_KEY should be set in console
    # NANGO_INTEGRATION_ID should be set in console
    NANGO_HOST: https://api.nango.dev

    # GitHub OAuth (if not using Nango)
    # GITHUB_CLIENT_ID should be set in console
    # GITHUB_CLIENT_SECRET should be set in console
    # GITHUB_CALLBACK_URL should be set in console

    # Frontend URL for CORS
    # FRONTEND_URL should be set in console

    # S3 Storage
    # S3_BUCKET should be set in console
    # S3_REGION should be set in console
    # S3_ACCESS_KEY_ID should be set in console
    # S3_SECRET_ACCESS_KEY should be set in console
    S3_ENDPOINT: https://s3.amazonaws.com

    # Rate Limiting
    RATE_LIMIT_MAX: 100
    RATE_LIMIT_WINDOW: 60000

    # Package Settings
    MAX_PACKAGE_SIZE: 10485760
    ALLOWED_FILE_EXTENSIONS: .md,.json,.yaml,.yml,.txt

    # AI Quality Evaluation
    # ANTHROPIC_API_KEY should be set in console
    AI_EVALUATION_ENABLED: true

    # Telemetry
    ENABLE_TELEMETRY: true
    # POSTHOG_API_KEY and POSTHOG_HOST can be set if needed

  # Health check configuration
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /health

  # Process configuration
  aws:elasticbeanstalk:environment:process:default:
    DeregistrationDelay: 20  # Reduce from default 300s to 20s for faster instance removal
    HealthCheckTimeout: 30
    HealthCheckInterval: 60
    HealthyThresholdCount: 2
    UnhealthyThresholdCount: 5
    HealthCheckPath: /health
    Port: 8080
    Protocol: HTTP

  # Enable CloudWatch logs
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7
