# Seed database with initial data
# Only runs once on initial deployment or when manually triggered
# Set ENABLE_SEEDING=true in environment variables to run

container_commands:
  04_seed_packages:
    command: |
      if [ "$ENABLE_SEEDING" = "true" ]; then
        echo "üå± Seeding packages..."
        npm run seed:packages
        echo "‚úÖ Packages seeded"
      else
        echo "‚è≠Ô∏è  Skipping seeding (ENABLE_SEEDING not set to true)"
      fi
    leader_only: true
    env:
      DATABASE_URL: $DATABASE_URL
      S3_BUCKET: $S3_BUCKET
      S3_REGION: $S3_REGION
      S3_ENDPOINT: $S3_ENDPOINT
      S3_ACCESS_KEY_ID: $S3_ACCESS_KEY_ID
      S3_SECRET_ACCESS_KEY: $S3_SECRET_ACCESS_KEY

  05_seed_prpm_skills:
    command: |
      if [ "$ENABLE_SEEDING" = "true" ]; then
        echo "üå± Seeding PRPM skills..."
        npm run seed:prpm-skills
        echo "‚úÖ PRPM skills seeded"
      else
        echo "‚è≠Ô∏è  Skipping PRPM skills seeding"
      fi
    leader_only: true
    env:
      DATABASE_URL: $DATABASE_URL
      S3_BUCKET: $S3_BUCKET
      S3_REGION: $S3_REGION
      S3_ENDPOINT: $S3_ENDPOINT
      S3_ACCESS_KEY_ID: $S3_ACCESS_KEY_ID
      S3_SECRET_ACCESS_KEY: $S3_SECRET_ACCESS_KEY

  06_seed_new_skills:
    command: |
      if [ "$ENABLE_SEEDING" = "true" ]; then
        echo "üå± Seeding new skills..."
        npm run seed:new-skills
        echo "‚úÖ New skills seeded"
      else
        echo "‚è≠Ô∏è  Skipping new skills seeding"
      fi
    leader_only: true
    env:
      DATABASE_URL: $DATABASE_URL
      S3_BUCKET: $S3_BUCKET
      S3_REGION: $S3_REGION
      S3_ENDPOINT: $S3_ENDPOINT
      S3_ACCESS_KEY_ID: $S3_ACCESS_KEY_ID
      S3_SECRET_ACCESS_KEY: $S3_SECRET_ACCESS_KEY

  07_seed_collections:
    command: |
      if [ "$ENABLE_SEEDING" = "true" ]; then
        echo "üå± Seeding collections..."
        npm run seed:collections
        echo "‚úÖ Collections seeded"
      else
        echo "‚è≠Ô∏è  Skipping collections seeding"
      fi
    leader_only: true
    env:
      DATABASE_URL: $DATABASE_URL
      S3_BUCKET: $S3_BUCKET
      S3_REGION: $S3_REGION
      S3_ENDPOINT: $S3_ENDPOINT
      S3_ACCESS_KEY_ID: $S3_ACCESS_KEY_ID
      S3_SECRET_ACCESS_KEY: $S3_SECRET_ACCESS_KEY

  08_seed_complete:
    command: |
      if [ "$ENABLE_SEEDING" = "true" ]; then
        echo "‚úÖ All seeding complete! Disabling ENABLE_SEEDING..."
        # Note: To re-enable, manually set ENABLE_SEEDING=true in EB console
      fi
    leader_only: true
